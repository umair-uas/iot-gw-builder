<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - IoT Gateway</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <header class="navbar">
        <nav>
            <h1>IoT Gateway</h1>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/status">Status</a></li>
                <li><a href="/clients">Clients</a></li>
                <li><a href="/settings" class="active">Settings</a></li>
            </ul>
        </nav>
    </header>
    <main class="content">
        <h2>Device Settings</h2>
        <form id="settings-form">
            <!-- Wi-Fi Configuration -->
            <div class="form-group">
                <label for="wifi-ssid">Wi-Fi SSID:</label>
                <input type="text" id="wifi-ssid" name="wifi-ssid" placeholder="Enter SSID" required>
            </div>
            <div class="form-group">
                <label for="wifi-password">Wi-Fi Password:</label>
                <input type="password" id="wifi-password" name="wifi-password" placeholder="Enter Password" required>
            </div>
            
            <!-- Update Interval Configuration -->
            <div class="form-group">
                <label for="update-interval">Data Update Interval (seconds):</label>
                <input type="number" id="update-interval" name="update-interval" placeholder="Enter interval" min="1" required>
            </div>
            
            <!-- Save Button -->
            <div class="form-actions">
                <button type="submit" class="btn">Save Settings</button>
            </div>
        </form>
    </main>
    <footer>
        <p>&copy; 2024 IoT Gateway | Designed with ❤️</p>
    </footer>
    
    <script src="/js/app.js"></script>
    <script>
        // Handle form submission
        document.getElementById('settings-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const ssid = document.getElementById('wifi-ssid').value;
            const password = document.getElementById('wifi-password').value;
            const updateInterval = document.getElementById('update-interval').value;

            const settings = {
                ssid,
                password,
                updateInterval,
            };

            try {
                const response = await fetch('/api/settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(settings),
                });
                if (response.ok) {
                    alert('Settings saved successfully!');
                } else {
                    alert('Failed to save settings!');
                }
            } catch (error) {
                console.error('Error saving settings:', error);
                alert('An error occurred while saving settings.');
            }
        });
    </script>
</body>
</html>
